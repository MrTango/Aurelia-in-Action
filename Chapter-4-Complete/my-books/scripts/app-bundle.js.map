{"version":3,"sources":["app.js","environment.js","index.js","main.js","resources/index.js","services/book-api.js","resources/attributes/tooltip.js","resources/elements/book-list.js","resources/elements/book-stats.js","resources/elements/book.js","resources/elements/books.js","resources/elements/edit-book.js","resources/elements/star-rating.js","resources/value-converters/book-status.js","resources/value-converters/date-format.js"],"names":["App","configureRouter","config","router","title","map","route","name","moduleId","debug","testing","Index","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","BookApi","http","getBooks","fetch","response","json","books","saveBook","book","setTimeout","resolve","TooltipCustomAttribute","Element","element","attached","$","tooltip","placement","detached","BookList","eventAggregator","BookStats","length","originalNumberOfBooks","Book","editMode","markRead","readDate","Date","read","removeBook","publish","toggleEditMode","event","bind","subscribeToEvents","editModeChangedSubscription","subscribe","mode","unbind","dispose","Books","bookApi","bookTitle","addBook","push","toRemove","bookIndex","findIndex","Id","splice","savedBooks","bookRemovedSubscription","bookSavedSubscription","bookSaved","updatedBook","savedBook","EditBook","ratingChangedListener","temporaryBook","rating","e","resetTempBook","ratingElement","addEventListener","editModeChanged","editModeNew","editModeOld","Object","assign","cancel","starRatingViewModel","applyRating","save","loading","publishBookSavedEvent","bookSaveComplete","saved","bookSaveCompleteSubscription","removeEventListener","isEqual","StarRating","stars","type","displayType","rated","hovered","forEach","star","index","rateStar","toggleOn","toggleOff","ratingFromIndex","rate","raiseChangedEvent","mouseOut","hoverIndex","applyHoverState","shouldApplyHover","toggleDisplayOn","toggleDisplayOff","mouseOver","starIndex","changeEvent","CustomEvent","dispatchEvent","BookStatusValueConverter","toView","value","DateFormatValueConverter","format"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\r\n  configureRouter(config, router) {\r\n  this.router = router;\r\n  config.title = 'My-Books';\r\n  config.map([ \r\n   { route: ['', 'home'], name: 'home', moduleId: 'index' },\r\n   { route: 'books', name: 'books', moduleId: './resources/elements/books'},\r\n  ]);\r\n  }\r\n}","export default {\n  debug: true,\n  testing: true\n};\n","export class Index{\r\n}","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {HttpClient} from 'aurelia-fetch-client';\r\nimport {inject} from 'aurelia-framework';\r\n\r\n@inject(HttpClient)\r\nexport class BookApi{\r\n    \r\n    constructor(http){\r\n        this.http = http;\r\n    }\r\n\r\n    getBooks(){\r\n\r\n        return this.http.fetch('books.json')\r\n                 .then(response => response.json())\r\n                 .then(books => {\r\n                   return books;\r\n                 });\r\n\r\n  }\r\n\r\n  saveBook(book){\r\n    return new Promise(resolve => {\r\n      setTimeout(() => {\r\n        resolve(book);\r\n      }, 1000);\r\n    });\r\n  }\r\n}","import {inject, bindable} from 'aurelia-framework';\r\n\r\n@inject(Element)\r\nexport class TooltipCustomAttribute{\r\n\r\n    @bindable title;\r\n    @bindable placement;\r\n\r\n    constructor(element){\r\n        this.element = element;\r\n    }\r\n\r\n    attached(){\r\n        $(this.element).tooltip({title: this.title, placement : this.placement});\r\n    }   \r\n    \r\n    detached(){\r\n        $(this.element).tooltip('dispose');\r\n    } \r\n}","import {bindable, inject} from 'aurelia-framework';\r\nimport {EventAggregator} from 'aurelia-event-aggregator';\r\n\r\n@inject(EventAggregator)\r\nexport class BookList {\r\n  @bindable books;\r\n  \r\n  constructor(eventAggregator){\r\n    this.eventAggregator = eventAggregator;\r\n  }\r\n}","import {computedFrom, bindable} from 'aurelia-framework'; \r\n\r\nexport class BookStats{\r\n \r\n  @bindable books;\r\n  @bindable originalNumberOfBooks;\r\n\r\n  @computedFrom('originalNumberOfBooks', 'books.length')\r\n  get addedBooks(){\r\n      return this.books.length - this.originalNumberOfBooks; \r\n  }\r\n}\r\n","import {bindable, inject} from 'aurelia-framework';\r\nimport {EventAggregator} from 'aurelia-event-aggregator';\r\n\r\n@inject(EventAggregator)\r\nexport class Book{\r\n\r\n    @bindable book;   \r\n\r\n    constructor(eventAggregator){\r\n        this.eventAggregator = eventAggregator;\r\n        this.editMode = false;\r\n    }\r\n\r\n    markRead(){\r\n        this.book.readDate = new Date();\r\n        this.book.read = true;\r\n    }\r\n\r\n    removeBook(){\r\n        this.eventAggregator.publish('book-removed', this.book);\r\n    }\r\n\r\n    toggleEditMode(event){\r\n        this.editMode = !this.editMode;\r\n    }\r\n\r\n    bind(){\r\n        this.subscribeToEvents();\r\n    }\r\n    \r\n    subscribeToEvents(){\r\n        this.editModeChangedSubscription = \r\n            this.eventAggregator.subscribe('edit-mode-changed', mode => {\r\n                                             this.editMode = mode; \r\n        });\r\n    }\r\n\r\n    unbind(){\r\n        this.editModeChangedSubscription.dispose();\r\n    }\r\n}","import {bindable, inject, computedFrom} from 'aurelia-framework';\r\nimport {BookApi} from '../../services/book-api';\r\nimport {EventAggregator} from 'aurelia-event-aggregator';\r\nimport _ from 'lodash';\r\n\r\n@inject(BookApi, EventAggregator)\r\nexport class Books {\r\n\r\n  constructor(bookApi, eventAggregator){\r\n    this.bookTitle = \"\"; \r\n    this.books = [];\r\n    this.bookApi = bookApi;\r\n    this.eventAggregator = eventAggregator;\r\n  }\r\n  \r\n  addBook () {\r\n    this.books.push({title : this.bookTitle});\r\n    this.bookTitle = \"\";\r\n  }\r\n  \r\n  removeBook(toRemove){\r\n    \r\n    let bookIndex = _.findIndex(this.books, book => {\r\n      return book.Id === toRemove.Id;\r\n    });\r\n\r\n    this.books.splice(bookIndex, 1);\r\n  }\r\n\r\n  bind(){\r\n    this.bookApi.getBooks()\r\n                .then(savedBooks => \r\n                      this.books = savedBooks);\r\n  }\r\n\r\n  attached(){\r\n    this.subscribeToEvents();\r\n  }\r\n\r\n  subscribeToEvents(){\r\n      this.bookRemovedSubscription = \r\n           this.eventAggregator.subscribe('book-removed', \r\n                                bookIndex => this.removeBook(bookIndex));\r\n\r\n      this.bookSavedSubscription = \r\n      this.eventAggregator.subscribe('save-book', \r\n                                     book => this.bookSaved(book));\r\n  }\r\n\r\n  bookSaved(updatedBook){\r\n      this.bookApi\r\n          .saveBook(updatedBook)\r\n          .then((savedBook) => this.eventAggregator\r\n                                  .publish(`book-save-complete-${savedBook.Id}`));\r\n  }\r\n  \r\n  @computedFrom('bookTitle.length') \r\n  get canAdd(){\r\n      return this.bookTitle.length === 0;\r\n  }\r\n\r\n  detached(){\r\n    this.bookRemovedSubscription.dispose();\r\n    this.bookSavedSubscription.dispose();\r\n  }\r\n}\r\n","import {bindable, inject, computedFrom} from 'aurelia-framework';\r\nimport {EventAggregator} from 'aurelia-event-aggregator';\r\nimport _ from 'lodash';\r\n\r\n@inject(EventAggregator,)\r\nexport class EditBook{\r\n    \r\n    @bindable editMode;\r\n    @bindable book;\r\n\r\n    constructor(eventAggregator){\r\n        this.eventAggregator = eventAggregator;\r\n        this.ratingChangedListener =  e => this.temporaryBook.rating = e.rating;\r\n    }\r\n\r\n    bind(){\r\n        this.resetTempBook(); \r\n        this.ratingElement.addEventListener(\"change\", this.ratingChangedListener);\r\n    }\r\n\r\n    editModeChanged(editModeNew, editModeOld){\r\n        if(editModeNew) this.resetTempBook();\r\n    }\r\n\r\n    @computedFrom('temporaryBook.title', 'temporaryBook.description', 'temporaryBook.rating')\r\n    get canSave(){\r\n        return this.temporaryBook && !_.isEqual(this.temporaryBook, this.book);\r\n    }\r\n\r\n    resetTempBook(){\r\n        this.temporaryBook = Object.assign({}, this.book);\r\n    }\r\n\r\n    cancel(){\r\n        this.temporaryBook = this.book;\r\n        this.starRatingViewModel.applyRating(this.temporaryBook.rating);\r\n        this.toggleEditMode();\r\n    }\r\n    \r\n    save(){\r\n        this.loading = true;\r\n        this.publishBookSavedEvent();\r\n        \r\n    }\r\n\r\n    bookSaveComplete(){\r\n        this.loading = false;\r\n        this.saved = true;\r\n        setTimeout(() => {\r\n           this.saved = false;\r\n           this.toggleEditMode();  \r\n        }, 500);  \r\n    }\r\n\r\n    publishBookSavedEvent(){\r\n        this.eventAggregator.publish('save-book', this.temporaryBook);\r\n    }\r\n\r\n    attached(){\r\n        this.bookSaveCompleteSubscription = this.eventAggregator.subscribe(`book-save-complete-${this.book.Id}`, () =>  this.bookSaveComplete());\r\n    }\r\n\r\n    toggleEditMode(){\r\n        this.eventAggregator.publish('edit-mode-changed', !this.editMode );\r\n    }\r\n\r\n    detached(){\r\n        this.ratingElement.removeEventListener('change', this.ratingChangedListener);\r\n        this.bookSaveCompleteSubscription.dispose();\r\n    }\r\n}","import {inject, bindable} from 'aurelia-framework';\r\n\r\n@inject(Element) // Inject the instance of this element\r\nexport class StarRating{\r\n    \r\n    @bindable rating;\r\n\r\n    constructor(element){\r\n\r\n        this.element = element;\r\n        this.stars = [\r\n                        { type: '-o', displayType: '-o', rated : false },\r\n                        { type: '-o', displayType: '-o', rated : false },\r\n                        { type: '-o', displayType: '-o', rated : false },\r\n                        { type: '-o', displayType: '-o', rated : false },\r\n                        { type: '-o', displayType: '-o', rated : false }\r\n                    ];\r\n\r\n        this.hovered = false;\r\n    }\r\n\r\n    bind(){\r\n        this.applyRating(this.rating);\r\n    }\r\n\r\n    applyRating(rating){\r\n        this.stars.forEach((star, index) => \r\n                            this.rateStar(star, rating, index));\r\n    }\r\n\r\n    rateStar(star, rating, index){\r\n \r\n        if(index < rating) this.toggleOn(star);\r\n        else {\r\n            this.toggleOff(star);\r\n        }\r\n        \r\n    }\r\n\r\n    toggleOn(star){\r\n        star.displayType = '';\r\n        star.type = '';\r\n        star.rated = true;\r\n    }\r\n\r\n    toggleOff(star){\r\n        star.displayType = '-o';\r\n        star.type = '-o';\r\n        star.rated = false;\r\n    }\r\n\r\n    ratingFromIndex(index, star){\r\n\r\n        if(index === 0 && star.rated) return 0;\r\n\r\n        return index + 1;\r\n\r\n    }\r\n\r\n    rate(index){\r\n\r\n        let rating = this.ratingFromIndex(index, this.stars[0]);\r\n\r\n        this.rating = rating;\r\n        \r\n        this.applyRating(rating);\r\n        \r\n        this.raiseChangedEvent();\r\n\r\n    }\r\n\r\n    mouseOut(hoverIndex){\r\n        \r\n        if(!this.hovered) return;\r\n\r\n        this.hovered = false;\r\n\r\n        this.applyHoverState(hoverIndex);\r\n       \r\n    }\r\n\r\n    applyHoverState(hoverIndex){\r\n         this.stars.forEach((star, index) =>{\r\n            if(!this.shouldApplyHover(index, hoverIndex, star)) return;\r\n\r\n            if(this.hovered){\r\n                this.toggleDisplayOn(star);\r\n            }\r\n            else{\r\n                 this.toggleDisplayOff(star);\r\n            }\r\n        }); \r\n    }\r\n\r\n    mouseOver(hoverIndex){\r\n        if(this.hovered) return;\r\n\r\n        this.hovered = true;\r\n\r\n        this.applyHoverState(hoverIndex);\r\n    }\r\n\r\n    toggleDisplayOff(star){\r\n        star.displayType = star.type; \r\n    }\r\n\r\n    toggleDisplayOn(star){\r\n        star.displayType = '';\r\n    }\r\n\r\n    shouldApplyHover(starIndex, hoverIndex, star){\r\n        return starIndex <= hoverIndex && !star.rated;\r\n    }\r\n\r\n    raiseChangedEvent(){\r\n        let changeEvent = new CustomEvent('change', {rating: this.rating});\r\n    \r\n        this.element.dispatchEvent(changeEvent);\r\n    }\r\n}","export class BookStatusValueConverter{\r\n    toView(value) {\r\n\r\n        switch(value){\r\n            case 'bad':\r\n                return 'fa-frown-o';\r\n            case 'good':\r\n                return 'fa-smile-o';\r\n            case 'ok':\r\n                return 'fa-meh-o';\r\n        }\r\n    \r\n    }\r\n}","import moment from 'moment';\r\n\r\nexport class DateFormatValueConverter {\r\n  toView(value) {\r\n    if(!value) return '';\r\n\r\n    return moment(value).format('MM/DD/YYYY h:mm:ss a');\r\n  }\r\n}"],"sourceRoot":".."}